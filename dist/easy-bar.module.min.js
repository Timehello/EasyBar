var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,r){for(var l=0;l<r.length;l++){var o=r[l];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,l,o){return l&&e(r.prototype,l),o&&e(r,o),r}}(),Utils=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"hasClass",value:function(e,r){return e.classList?e.classList.contains(r):new RegExp("\\b"+r+"\\b").test(e.className)}},{key:"addClass",value:function(e,r){e.classList?e.classList.add(r):hasClass(e,r)||(e.className+=" "+r)}},{key:"removeClass",value:function(e,r){e.classList?e.classList.remove(r):e.className=e.className.replace(new RegExp("\\b"+r+"\\b","g"),"")}},{key:"compatStyle",value:function(e,r,l){var o=r.slice(0,1).toUpperCase()+r.substring(1);e.style["webkit"+o]=l,e.style["moz"+o]=l,e.style["ms"+o]=l,e.style["o"+o]=l,e.style[r]=l}},{key:"debounce",value:function(e,r,l){var o=null;return function(){var t=this,n=arguments;clearTimeout(o);var s=r?r.apply(t,n):void 0;if(s?o=setTimeout(function(){e.apply(t,n)},s):e.apply(t,n),l)return l.apply(t,n)}}},{key:"throttle",value:function(e,r,l){var o,t;return function(){var n=this,s=+new Date,a=arguments,i=r?r.apply(n,a):void 0;if(o&&i&&s<o+i?(clearTimeout(t),t=setTimeout(function(){o=s,e.apply(n,a)},i)):(o=s,e.apply(n,a)),l)return l.apply(n,a)}}}]),e}(),BrowserUtils=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"isFirefox",value:function(){return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}}]),e}(),DefConfig={minLength:50,maxLength:-1,resizeRefresh:!0,barfloat:!1,preventParentScroll:!1,scrollBarBehavior:null,scrollThrottle:10,draggerThrottle:10,observerThrottle:200,resizeDebounce:200,scrollingPhantomDelay:1e3,draggingPhantomDelay:1e3,clsBox:"eb",clsBoxScrolling:"eb-scrolling",clsBoxScrollingPhantom:"eb-scrolling-phantom",clsBoxDragging:"eb-dragging",clsBoxDraggingPhantomClass:"eb-dragging-phantom",clsBoxVisibleBarV:"eb-visible-v",clsBoxInvisibleBarV:"eb-invisible-v",clsBoxVisibleBarH:"eb-visible-h",clsBoxInvisibleBarH:"eb-invisible-h",clsContent:"eb-content",clsTrackV:"eb-track-v",clsThumbV:"eb-thumb-v",clsTrackH:"eb-track-h",clsThumbH:"eb-thumb-h"};function styleInject(e,r){void 0===r&&(r={});var l=r.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css","top"===l&&o.firstChild?o.insertBefore(t,o.firstChild):o.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}}var css=".hide-native-bar::-webkit-scrollbar{display:none}.hide-native-bar::-o-scrollbar{display:none}.hide-native-bar{-ms-overflow-style:none}.eb>.eb-track-h,.eb>.eb-track-v{-webkit-transition:background-color .3s;transition:background-color .3s;z-index:1;border-radius:20px}.eb>.eb-track-v{width:8px;top:5px;right:5px;height:calc(100% - 20px)}.eb>.eb-track-h{height:8px;left:5px;bottom:5px;width:calc(100% - 20px)}.eb.eb-visible-h.eb-scrolling-phantom>.eb-track-h,.eb.eb-visible-h>.eb-track-h:hover,.eb.eb-visible-v.eb-scrolling-phantom>.eb-track-v,.eb.eb-visible-v>.eb-track-v:hover{-webkit-transition:background-color .1s;transition:background-color .1s;background-color:rgba(0,0,0,.1)}.eb.eb-visible-h>.eb-track-h>.eb-thumb-h,.eb.eb-visible-v>.eb-track-v>.eb-thumb-v{-webkit-transition:background-color .3s;transition:background-color .3s;background-color:rgba(0,0,0,.15);border-radius:20px;display:block}.eb>.eb-track-v>.eb-thumb-v{width:100%}.eb>.eb-track-h>.eb-thumb-h{height:100%}.eb.eb-visible-h.eb-scrolling-phantom>.eb-track-h>.eb-thumb-h,.eb.eb-visible-h>.eb-track-h:hover>.eb-thumb-h,.eb.eb-visible-v.eb-scrolling-phantom>.eb-track-v>.eb-thumb-v,.eb.eb-visible-v>.eb-track-v:hover>.eb-thumb-v{-webkit-transition:background-color .1s;transition:background-color .1s;background-color:rgba(0,0,0,.3)}";styleInject(css);var HideNativeBarClass="hide-native-bar",IsFirefox=BrowserUtils.isFirefox();function checkCevEl(e){return!!e.firstElementChild}function getNativeScrollbarWidth(){var e=document.body,r=document.createElement("div"),l=document.createElement("div");r.className=HideNativeBarClass,r.style.position="absolute",r.style.pointerEvents="none",r.style.bottom="0",r.style.right="0",r.style.width="100px",r.style.height="100px",r.style.overflow="hidden",l.style.width="100%",l.style.height="100%",r.appendChild(l),e.appendChild(r);var o=l.offsetWidth,t=l.offsetHeight;r.style.overflow="scroll";var n=o-l.offsetWidth,s=t-l.offsetHeight;return e.removeChild(r),{v:n,h:s}}function createBar(){var e=document.createElement("div");e.style.position="absolute";var r=document.createElement("div");return r.style.position="absolute",e.appendChild(r),{scrollBarTrack:e,scrollBarThumb:r}}function careteMutationObserver(e){return("undefined"==typeof MutationObserver?"undefined":_typeof(MutationObserver))===_typeof(void 0)?null:new MutationObserver(Utils.throttle(function(){_refreshBar(e)},function(){return e.config.observerThrottle}))}function initScrollHandler(e){e.scrollHandler||(e.scrollHandler=Utils.throttle(function(){computeArea(e),updateScrollBar(e),updateScrollBar(e),withScrollingClass(e)},function(){return e.config.scrollThrottle}))}function initMouseDown(e){e.mouseDown||(e.mouseDown=function(r){if(!r.targetTouches&&1!==r.which)return!1;var l=r.targetTouches?r.targetTouches[0]:r;if(e.vBar&&this==e.vBar.scrollBarThumb)e.vBar.barDragging=!0,e.vBar.startMouse=l.clientY-e.vBar.scrollBarThumb.getBoundingClientRect().top;else{if(!e.hBar||this!=e.hBar.scrollBarThumb)return!1;e.hBar.barDragging=!0,e.hBar.startMouse=l.clientX-e.hBar.scrollBarThumb.getBoundingClientRect().left}Utils.addClass(e.scrollBox,e.config.clsBoxDragging),e.draggingPhantomClassTimer&&clearTimeout(e.draggingPhantomClassTimer),Utils.addClass(e.scrollBox,e.config.clsBoxDraggingPhantomClass),document.addEventListener("mousemove",e.mouseMove,1),document.addEventListener("mouseup",e.mouseUp,1),document.addEventListener("touchmove",e.mouseMove,1),document.addEventListener("touchend",e.mouseUp,1),r.preventDefault(),r.stopPropagation()})}function initMouseMove(e){e.mouseMove||(e.mouseMove=Utils.throttle(function(r){var l=r.targetTouches?r.targetTouches[0]:r;onDragging(e,l)},function(){return e.config.draggerThrottle},function(e){e.preventDefault(),e.stopPropagation()}))}function initMouseUp(e){e.mouseUp||(e.mouseUp=function(r){e.vBar&&(e.vBar.barDragging=!1),e.hBar&&(e.hBar.barDragging=!1),Utils.removeClass(e.scrollBox,e.config.clsBoxDragging),e.draggingPhantomClassTimer&&clearTimeout(e.draggingPhantomClassTimer),e.draggingPhantomClassTimer=setTimeout(function(){Utils.removeClass(e.scrollBox,e.config.clsBoxDraggingPhantomClass),e.draggingPhantomClassTimer&&delete e.draggingPhantomClassTimer},e.config.draggingPhantomDelay),document.removeEventListener("mousemove",e.mouseMove,1),document.removeEventListener("mouseup",e.mouseUp,1),document.removeEventListener("touchmove",e.mouseMove,1),document.removeEventListener("touchend",e.mouseUp,1),r.preventDefault(),r.stopPropagation()})}function bindWheelHandler(e){e.config.preventParentScroll?e.wheelHandler||(e.wheelHandler=function(r){if(e.visibleArea>=1)return!1;var l=e.scrollCevBox.scrollHeight-e.scrollCevBox.clientHeight,o=e.scrollCevBox.scrollTop,t=r.deltaY<0,n=r.deltaY>0;if(o<=0&&t||o>=l&&n)return r.preventDefault(),!1;var s=e.scrollCevBox.scrollHeight-e.scrollCevBox.clientHeight,a=e.scrollCevBox.scrollLeft,i=r.deltaX<0,c=r.deltaX>0;return a<=0&&i||a>=s&&c?(r.preventDefault(),!1):(r.stopPropagation(),!0)},e.scrollCevBox.addEventListener("wheel",e.wheelHandler,0)):unBindWheelHandler(e)}function unBindWheelHandler(e){e.wheelHandler&&(e.scrollCevBox.removeEventListener("wheel",e.wheelHandler,0),delete e.wheelHandler)}function bindResizeHandler(e){e.config.resizeRefresh?e.resizeHandler||(e.resizeHandler=Utils.debounce(function(){_refreshBar(e)},function(){return e.config.resizeDebounce}),window.addEventListener("resize",e.resizeHandler,0)):unBindResizeHandler(e)}function unBindResizeHandler(e){e.resizeHandler&&(window.removeEventListener("resize",e.resizeHandler,0),delete e.resizeHandler)}function bindScrollBox(e){e.scrollCevBox||(e.scrollBox=e.rootEl,e.scrollBoxClip=document.createElement("div"),e.scrollCev=e.rootEl.firstElementChild,e.scrollCevBox=document.createElement("div"),Utils.addClass(e.scrollBox,e.config.clsBox),e.scrollBox.style.position="relative",e.scrollBox.style.overflow="hidden",e.scrollBoxClip.style.height="100%",e.scrollBoxClip.style.width="100%",e.scrollBoxClip.style.overflow="hidden",Utils.addClass(e.scrollCevBox,e.config.clsContent),Utils.addClass(e.scrollCevBox,HideNativeBarClass),e.scrollCevBox.style.display="block",e.scrollCevBox.style.overflow="hidden",e.scrollCevBox.style.height="100%",e.scrollCevBox.style.width="100%",e.scrollBox.removeChild(e.scrollCev),e.scrollCevBox.appendChild(e.scrollCev),e.scrollBoxClip.appendChild(e.scrollCevBox),e.scrollBox.appendChild(e.scrollBoxClip),e.scrollCevBox.addEventListener("scroll",e.scrollHandler,0),e.mutationObserver=careteMutationObserver(e),e.mutationObserver&&e.mutationObserver.observe(e.scrollCevBox,{childList:!0,characterData:!0,subtree:!0}))}function unBindScrollBox(e){e.scrollCevBox&&(Utils.removeClass(e.scrollBox,e.config.clsBox),e.scrollBox.style.position="",e.scrollBox.style.overflow="",e.scrollCev.style.display="",e.scrollBox.removeChild(e.scrollBoxClip),e.scrollCevBox.removeChild(e.scrollCev),e.scrollBox.appendChild(e.scrollCev),e.scrollCevBox.removeEventListener("scroll",e.scrollHandler,0),e.mutationObserver&&(e.mutationObserver.disconnect(),delete e.mutationObserver),delete e.scrollCev,delete e.scrollCevBox,delete e.scrollBoxClip,delete e.scrollBox)}function bindScrollBar(e){var r;e.barBehavior.vBarEnable&&e.barBehavior.vBarShow?(e.vBar||(r=createBar(),e.vBar={scrollBarTrack:r.scrollBarTrack,scrollBarThumb:r.scrollBarThumb},Utils.compatStyle(e.vBar.scrollBarTrack,"userSelect","none"),e.scrollBox.appendChild(e.vBar.scrollBarTrack),e.vBar.scrollBarThumb.addEventListener("mousedown",e.mouseDown,0),e.vBar.scrollBarThumb.addEventListener("touchstart",e.mouseDown,0)),e.vBar.scrollBarTrack.className=e.config.clsTrackV,e.vBar.scrollBarThumb.className=e.config.clsThumbV):unBindScrollBarV(e),e.barBehavior.hBarEnable&&e.barBehavior.hBarShow?(e.hBar||(r=createBar(),e.hBar={scrollBarTrack:r.scrollBarTrack,scrollBarThumb:r.scrollBarThumb},Utils.compatStyle(e.hBar.scrollBarTrack,"userSelect","none"),e.scrollBox.appendChild(e.hBar.scrollBarTrack),e.hBar.scrollBarThumb.addEventListener("mousedown",e.mouseDown,0),e.hBar.scrollBarThumb.addEventListener("touchstart",e.mouseDown,0)),e.hBar.scrollBarTrack.className=e.config.clsTrackH,e.hBar.scrollBarThumb.className=e.config.clsThumbH):unBindScrollBarH(e),updateScrollCevBoxStyle(e)}function updateScrollCevBoxStyle(e){if(e.vBar||e.hBar){var r=getNativeScrollbarWidth();e.vBar?(e.scrollCevBox.style.overflowY="scroll",e.scrollCevBox.style.width="calc(100% + "+r.v+"px)",IsFirefox&&0==r.v&&(e.vBar.scrollBarTrack.style.display="none")):(e.scrollCevBox.style.overflowY="hidden",e.scrollCevBox.style.width="100%"),e.hBar?(e.scrollCevBox.style.overflowX="scroll",e.scrollCevBox.style.height="calc(100% + "+r.h+"px)",IsFirefox&&0==r.h&&(e.hBar.scrollBarTrack.style.display="none")):(e.scrollCevBox.style.overflowX="hidden",e.scrollCevBox.style.height="100%")}else e.scrollCevBox.style.overflow="hidden",e.scrollCevBox.style.height="100%",e.scrollCevBox.style.width="100%"}function unBindScrollBar(e){unBindScrollBarV(e),unBindScrollBarH(e)}function unBindScrollBarV(e){e.vBar&&(e.vBar.scrollBarThumb.removeEventListener("mousedown",e.mouseDown,0),e.vBar.scrollBarThumb.removeEventListener("touchstart",e.mouseDown,0),e.scrollBox.removeChild(e.vBar.scrollBarTrack),delete e.vBar)}function unBindScrollBarH(e){e.hBar&&(e.hBar.scrollBarThumb.removeEventListener("mousedown",e.mouseDown,0),e.hBar.scrollBarThumb.removeEventListener("touchstart",e.mouseDown,0),e.scrollBox.removeChild(e.hBar.scrollBarTrack),delete e.hBar)}function computeArea(e){var r,l,o,t,n;(r=e.vBar)&&(l=0==e.scrollCevBox.scrollHeight?1:e.scrollCevBox.clientHeight/e.scrollCevBox.scrollHeight,r.scrollOffsetArea=l,r.barBoxLength=r.scrollBarTrack.clientHeight,l>=1?(r.barLength=0,Utils.removeClass(e.scrollBox,e.config.clsBoxVisibleBarV),Utils.addClass(e.scrollBox,e.config.clsBoxInvisibleBarV)):(t=o=r.scrollBarTrack.clientHeight*l,t=e.config.minLength>0&&e.config.minLength>t?e.config.minLength:t,t=e.config.maxLength>0&&e.config.maxLength<t?e.config.maxLength:t,r.barLength=t,n=(e.config.minLength>0?e.config.minLength:0)+100,r.barBoxLength=n>r.scrollBarTrack.clientHeight?n:r.scrollBarTrack.clientHeight,r.scrollOffsetArea=(r.barBoxLength-t)/(r.scrollBarTrack.clientHeight-o)*(r.scrollBarTrack.clientHeight/e.scrollCevBox.scrollHeight),Utils.removeClass(e.scrollBox,e.config.clsBoxInvisibleBarV),Utils.addClass(e.scrollBox,e.config.clsBoxVisibleBarV))),(r=e.hBar)&&(l=0==e.scrollCevBox.scrollWidth?1:e.scrollCevBox.clientWidth/e.scrollCevBox.scrollWidth,r.scrollOffsetArea=l,r.barBoxLength=r.scrollBarTrack.clientWidth,l>=1?(r.barLength=0,Utils.removeClass(e.scrollBox,e.config.clsBoxVisibleBarH),Utils.addClass(e.scrollBox,e.config.clsBoxInvisibleBarH)):(t=o=r.scrollBarTrack.clientWidth*l,t=e.config.minLength>0&&e.config.minLength>t?e.config.minLength:t,t=e.config.maxLength>0&&e.config.maxLength<t?e.config.maxLength:t,r.barLength=t,n=(e.config.minLength>0?e.config.minLength:0)+100,r.barBoxLength=n>r.scrollBarTrack.clientWidth?n:r.scrollBarTrack.clientWidth,r.scrollOffsetArea=(r.barBoxLength-t)/(r.scrollBarTrack.clientWidth-o)*(r.scrollBarTrack.clientWidth/e.scrollCevBox.scrollWidth),Utils.removeClass(e.scrollBox,e.config.clsBoxInvisibleBarH),Utils.addClass(e.scrollBox,e.config.clsBoxVisibleBarH)))}function updateScrollBar(e){var r;(r=e.vBar)&&(r.barOffset=e.scrollCevBox.scrollTop*r.scrollOffsetArea,r.scrollBarThumb.style.height=parseInt(Math.round(r.barLength))+"px",r.scrollBarThumb.style.top=parseInt(Math.round(r.barOffset))+"px"),(r=e.hBar)&&(r.barOffset=e.scrollCevBox.scrollLeft*r.scrollOffsetArea,r.scrollBarThumb.style.width=parseInt(Math.round(r.barLength))+"px",r.scrollBarThumb.style.left=parseInt(Math.round(r.barOffset))+"px")}function onDragging(e,r){var l,o,t=!1;return(l=e.vBar)&&l.barDragging&&((o=r.clientY-l.scrollBarTrack.getBoundingClientRect().top)<=l.startMouse&&(l.barOffset=0),o>l.startMouse&&(l.barOffset=o-l.startMouse),l.barOffset+l.barLength>=l.barBoxLength&&(l.barOffset=l.barBoxLength-l.barLength),e.scrollCevBox.scrollTop=l.barOffset/l.scrollOffsetArea,t=!0),(l=e.hBar)&&l.barDragging&&((o=r.clientX-l.scrollBarTrack.getBoundingClientRect().left)<=l.startMouse&&(l.barOffset=0),o>l.startMouse&&(l.barOffset=o-l.startMouse),l.barOffset+l.barLength>=l.barBoxLength&&(l.barOffset=l.barBoxLength-l.barLength),e.scrollCevBox.scrollLeft=l.barOffset/l.scrollOffsetArea,t=!0),t}function withScrollingClass(e){e.scrollingClassTimeout&&clearTimeout(e.scrollingClassTimeout),Utils.addClass(e.scrollBox,e.config.clsBoxScrolling),e.scrollingClassTimeout=setTimeout(function(){Utils.removeClass(e.scrollBox,e.config.clsBoxScrolling),e.scrollingClassTimeout&&delete e.scrollingClassTimeout},e.config.scrollThrottle+5),e.scrollingPhantomClassTimeout&&clearTimeout(e.scrollingPhantomClassTimeout),Utils.addClass(e.scrollBox,e.config.clsBoxScrollingPhantom),e.scrollingPhantomClassTimeout=setTimeout(function(){Utils.removeClass(e.scrollBox,e.config.clsBoxScrollingPhantom),e.scrollingPhantomClassTimeout&&delete e.scrollingPhantomClassTimeout},e.config.scrollThrottle+e.config.scrollingPhantomDelay)}function clearBarTimeout(e){e.draggingPhantomClassTimer&&clearTimeout(e.draggingPhantomClassTimer),e.scrollingClassTimeout&&clearTimeout(e.scrollingClassTimeout),e.scrollingPhantomClassTimeout&&clearTimeout(e.scrollingPhantomClassTimeout)}function init(e,r){e.nextTickHandler=r,initScrollHandler(e),initMouseDown(e),initMouseMove(e),initMouseUp(e)}function create(e){bindScrollBox(e),bindScrollBar(e),bindWheelHandler(e),bindResizeHandler(e)}function _refreshBar(e){var r=function(){e&&(computeArea(e),updateScrollBar(e))};e.nextTickHandler?e.nextTickHandler(r):r()}function destroy(e){clearBarTimeout(e),unBindResizeHandler(e),unBindWheelHandler(e),unBindScrollBar(e),unBindScrollBox(e)}function analyzeScrollBarBehavior(e){var r,l="show",o="show";(r=(e=e||"").match(/^\s*(show|hide|none)\s*$/i))?r.length>=2&&(l=o=r[1].toLowerCase()):(r=e.match(/^\s*(show|hide|none)\s+(show|hide|none)\s*$/i))&&r.length>=3&&(l=r[1].toLowerCase(),o=r[2].toLowerCase());var t=!0,n=!0;"none"==l?(t=!1,n=!1):"hide"==l&&(t=!0,n=!1);var s=!0,a=!0;return"none"==o?(s=!1,a=!1):"hide"==o&&(s=!0,a=!1),{vBarEnable:t,vBarShow:n,hBarEnable:s,hBarShow:a}}function setOptions(e,r){if(r)for(var l in r)e.config[l]=r[l];e.barBehavior=analyzeScrollBarBehavior(e.config.scrollBarBehavior)}var EasyBar=function(){function e(r,l){if(classCallCheck(this,e),!checkCevEl(r))return{};this.rootEl=r,this.config={},setOptions(this,DefConfig),init(this,l)}return createClass(e,[{key:"bind",value:function(e){return this.update(e),this}},{key:"update",value:function(e){return setOptions(this,e),create(this),_refreshBar(this),this}},{key:"refreshBar",value:function(){return _refreshBar(this),this}},{key:"unBind",value:function(){return destroy(this),this}}],[{key:"bind",value:function(r,l,o){return r._easyBar||(r._easyBar=new e(r,o).bind(l)),r._easyBar}},{key:"update",value:function(e,r){e._easyBar&&e._easyBar.update(r)}},{key:"get",value:function(e){return e._easyBar}},{key:"refreshBar",value:function(e){e._easyBar&&e._easyBar.refreshBar()}},{key:"unBind",value:function(e){e._easyBar&&(e._easyBar.unBind(),delete e._easyBar)}},{key:"install",value:function(r){r.directive("bar",{inserted:function(l,o){e.bind(l,o&&o.value?o.value:null,r.nextTick)},update:function(r,l){e.update(r,l&&l.value?l.value:null)},componentUpdated:function(r){e.refreshBar(r)},unbind:function(r){e.unBind(r)}}),Object.defineProperty(r.prototype,"$EasyBar",{get:function(){return e}})}}]),e}();export default EasyBar;
